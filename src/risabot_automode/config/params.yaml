# ============================================================
# RISA-Bot Centralized Parameters
# All tunable parameters in one place for easy competition-day tuning.
# Load via launch file: parameters=[params_file]
# ============================================================

# --- Auto Driver (brain) ---
auto_driver:
  ros__parameters:
    steering_gain: 1.0
    forward_speed: 0.12
    stale_timeout: 3.0
    dist_lap_complete: 1.0
    enable_subsumption_obstacle: false
    max_odom_speed: 1.0
    min_state_dwell_sec: 0.25
    publish_loop_stats: true

# --- Command Safety Controller ---
cmd_safety_controller:
  ros__parameters:
    publish_hz: 50.0
    cmd_timeout: 0.35
    max_linear_speed: 0.30
    max_angular_speed: 1.2
    max_linear_accel: 0.8
    max_angular_accel: 4.0
    deadband_linear: 0.01
    deadband_angular: 0.01
    publish_loop_stats: true

# --- Line Follower Camera ---
line_follower_camera:
  ros__parameters:
    smoothing_alpha: 0.3
    dead_zone: 0.08
    white_threshold: 150
    crop_ratio: 0.4
    show_debug: false
    resize_width: 320
    print_debug: false
    debug_print_rate: 0.5

# --- Traffic Light Detector ---
traffic_light_detector:
  ros__parameters:
    red_h_low1: 0
    red_h_high1: 10
    red_h_low2: 160
    red_h_high2: 180
    yellow_h_low: 20
    yellow_h_high: 35
    green_h_low: 40
    green_h_high: 85
    sat_min: 80
    val_min: 80
    min_circle_radius: 8
    max_circle_radius: 80
    min_pixel_count: 50
    required_confidence: 3
    show_debug: false
    resize_width: 320
    print_debug: false
    debug_print_rate: 0.5
    heartbeat_sec: 0.5

# --- Boom Gate Detector ---
boom_gate_detector:
  ros__parameters:
    min_detect_dist: 0.15
    max_detect_dist: 0.80
    angle_window: 0.35
    min_gate_points: 5
    distance_variance_max: 0.05
    lidar_angle_offset: 1.5708
    hysteresis: 3
    heartbeat_sec: 0.5

# --- Tunnel Wall Follower ---
tunnel_wall_follower:
  ros__parameters:
    target_center_dist: 0.0
    forward_speed: 0.15
    kp: 1.2
    kd: 0.3
    max_angular: 0.8
    left_angle_min: 0.52
    left_angle_max: 1.57
    right_angle_min: -1.57
    right_angle_max: -0.52
    lidar_angle_offset: 1.5708
    min_wall_points: 3
    max_wall_dist: 0.60
    heartbeat_sec: 0.2

# --- Obstruction Avoidance ---
obstruction_avoidance:
  ros__parameters:
    detect_dist: 0.50
    clear_dist: 0.60
    front_angle: 0.35
    side_angle_min: 0.35
    side_angle_max: 1.20
    steer_speed: 0.10
    steer_angular: 0.6
    pass_speed: 0.15
    pass_duration: 2.0
    steer_back_duration: 1.5
    steer_away_duration: 1.0
    lidar_angle_offset: 1.5708

# --- Parking Controller ---
parking_controller:
  ros__parameters:
    parallel_forward_dist: 0.30
    parallel_reverse_dist: 0.35
    parallel_steer_angle: 0.6
    park_wait_time: 3.0
    perp_turn_angle: 1.57
    perp_forward_dist: 0.25
    drive_speed: 0.15
    reverse_speed: -0.12
    signboard_min_area: 500
    signboard_resize_width: 320

# --- Camera Obstacle Detection ---
obstacle_avoidance_camera:
  ros__parameters:
    edge_threshold: 0.02
    canny_low: 50
    canny_high: 150
    blur_kernel: 5
    hysteresis_on: 3
    hysteresis_off: 5
    show_debug: false
    resize_width: 320
    print_debug: false
    debug_print_rate: 0.5
    heartbeat_sec: 0.5

# --- LiDAR Obstacle Detection ---
obstacle_avoidance_node:
  ros__parameters:
    min_obstacle_distance: 0.48
    heartbeat_sec: 0.5

# --- Dashboard ---
dashboard:
  ros__parameters:
    use_hw_odom: true
    freshness_stale_sec: 2.0
    sim_odom_scale: 1.55
    hw_odom_scale: 1.0
    hw_odom_yaw_scale: 1.0

# --- Health Monitor ---
health_monitor:
  ros__parameters:
    publish_period: 0.5
    timeout_perception: 1.5
    timeout_state: 2.0
    timeout_control: 1.0
    timeout_odom: 1.0
    timeout_joy: 2.0

# --- Servo Controller ---
servo_controller:
  ros__parameters:
    servo_steer_id: 4
    servo_center: 90
    servo_range: 50
    speed_levels: [15, 25, 40, 60, 100]
    default_speed_index: 1
    joy_timeout: 0.8
    auto_cmd_timeout: 0.4
    unlock_requires_neutral: true
    unlock_neutral_threshold: 0.15
    hw_heartbeat_sec: 1.0
    hw_fail_limit: 5
    ticks_per_meter: 1050.0
    odom_distance_scale: 1.0
    odom_yaw_scale: 1.0
    encoder_jump_threshold: 800.0
    max_linear_velocity: 1.0
    max_angular_velocity: 6.0
    odom_reverse_polarity: false
    wheel_base: 0.14
    steering_max_deg: 50.0
    odom_vel_alpha: 0.3
    odom_velocity_deadband: 0.02
    publish_loop_stats: true
    odom_frame_id: "odom"
    base_frame_id: "base_link"
